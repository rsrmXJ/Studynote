## Linux 磁盘配置与管理

##### 1\. 硬盘分区的分类

1\. 主分区（primary）。存放操作系统的启动或引导程序。

2\. 扩展分区（extended）。不是用来存放数据的，而是*为了创建逻辑分区*。**

Linux 中一个硬盘最多只允许有4个主分区，创建扩展分区时，会占用一个主分区的位置。*因此，*如果创建了扩展分区，一个硬盘上便最多只能创建3个主分区和一个扩展分区*。

3\. 逻辑分区（logical）。

通常逻辑分区是**存放文件和数据的地方。**

① 逻辑分区没有数量上的限制

② 逻辑分区不能够直接创建，它必须*依附在扩展分区下*，*容量受到扩展分区大小的限制*

##### 2\. 添加硬盘

步骤

① 分区。不是管是分一个分区还是多个分区。

② 格式化。分区必须经过格式化才能创建文件系统。

③ 挂载。被格式化的硬盘分区必须挂载到操作系统相应的文件目录下。

##### 3\. 查看磁盘设备和分区信息

`fdisk -l`命令查看当前系统所有磁盘设备及其分区的信息

```shell
磁盘 /dev/sda：53.7 GB, 53687091200 字节，104857600 个扇区
Units = 扇区 of 1 * 512 = 512 bytes
扇区大小(逻辑/物理)：512 字节 / 512 字节
I/O 大小(最小/最佳)：512 字节 / 512 字节
磁盘标签类型：dos
磁盘标识符：0x000cba0b

   设备 Boot      Start         End      Blocks   Id  System
/dev/sda1   *        2048     2099199     1048576   83  Linux
/dev/sda2         2099200   104857599    51379200   8e  Linux LVM

```

- 设备：分区的设备文件名称`/dev/sda`

- Boot：是否是引导分区。是，则带有“*”标识（/dev/sda1 *）
- Start：该分区在硬盘中的起始位置（柱面数
- End：该分区在硬盘中的结束位置（柱面数）
- Blocks：分区大小
- Id：分区类型的ID标记号。对于ext4分区为83，LVM分区为 8e

##### 4\. 硬盘分区

语法格式：

```
fdisk [选项] <磁盘>    更改分区表
fdisk [选项] -l <磁盘>  列出分区表
fdisk -s <分区>        给出分区大小(块数) 
```

##### 5\. 硬盘挂载

Linux系统中提供了两个默认的挂载目录：/media和/mnt。

1、/media用作系统自动挂载点。

2、/mnt用作手动挂载点。

从理论上讲，Linux系统中的任何一个目录都可以作为挂载点，但从系统的角度出发，以下几个目录是不能作为挂载点使用的：/bin、/sbin、/etc、/lib、/lib64目录。

##### 6\. 手动挂载

`mount [--source] <源> | [--target] <目录>·`

df命令查看挂载情况 `df -hT`

##### 7\. 逻辑管理卷 LVM

逻辑卷管理器(Logical Volume Manager，LVM)的设计目的就是**实现对磁盘的动态管理**，

LVM就建立在磁盘分区和文件系统之间的一个逻辑层，管理员利用LVM不用重新分区磁盘就可以动态调整文件系统的大小，并且利用LVM管理的文件系统可以跨越磁盘

##### 8\. LVM 中的几个概念

1\.物理存储介质（Physical Storage Media）

指系统的物理存储设备：磁盘（没有分区过的硬盘）

2\. 物理卷（Physical Volume，PV）

指*磁盘分区*或逻辑上与磁盘分区具有同样功能的设备

3\. 卷组（Volume Group，VG）

类似于非 LVM 系统中的物理磁盘，由一个或多个物理卷组成（分区过的硬盘跨多个硬盘）

4\. 逻辑卷（Logical Volume，LV）

卷组划分成若干个逻辑卷，相当于在逻辑硬盘上划分出几个逻辑分区

5\. 物理块 （Physical Eextent，PE）

每一个物理卷被划分成称为物理块的基本单元，具有唯一编号的物理块是可以被LVM寻址的最小单元，物理块的大小是可以配置的，默认为4MB，物理卷由大小相同的基本单元物理块组成。

##### 9\. 配置逻辑卷

第一步：先将磁盘分区 `fdisk`，并且将磁盘分区的类型设置为8e

第二部 创建物理卷

`pvcreate 硬盘分区① 硬盘分区② …`

`pvscan -s` 命令会扫描系统中连接的所有硬盘

-s 段格式输出

3\. 创建卷组

vgcreate 卷组名 物理卷

4\.  创建逻辑卷

lvcreate 逻辑卷名 卷组名

